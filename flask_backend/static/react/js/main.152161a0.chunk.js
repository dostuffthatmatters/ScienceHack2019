(this.webpackJsonpreact_frontend=this.webpackJsonpreact_frontend||[]).push([[0],{228:function(e,t){},286:function(e,t,a){e.exports=a(302)},291:function(e,t,a){},292:function(e,t,a){},300:function(e,t){},302:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(40),r=a.n(i),o=(a(291),a(256)),c=a(349),l=a(245),h=a(114),p=a(115),m=a(121),d=a(116),g=a(80),u=a(122);var f="https://science-hack-2019.herokuapp.com/backend/collection",b=a(357),v=a(348),O=a(149),E=a.n(O),y=(a(292),a(338)),M=a(339),k=a(340),D=a(303),N=a(341),j=a(342),x=a(343),C=a(258),S=a(336),Y=a(355),w=a(350),T=a(356),I=function(e){var t=s.a.useState(e.value),a=Object(C.a)(t,2),n=a[0],i=a[1];return s.a.createElement(S.a,{className:"className"in e?e.className:""},s.a.createElement(Y.a,{id:"select-label"},e.label),s.a.createElement(w.a,{labelId:"select-label",id:"demo-simple-select",value:n,onChange:function(t){i(t.target.value),"onChange"in e&&e.onChange(parseInt(t.target.value))}},Object.keys(e.selectOptions).map((function(t){return s.a.createElement(T.a,{value:t},e.selectOptions[t])}))))},V=function(e){function t(e){return Object(h.a)(this,t),Object(m.a)(this,Object(d.a)(t).call(this,e))}return Object(u.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.classes,n=this.props.selectOptions.months;return e="Odiac"===this.props.selectOptions.dataset[this.props.selection.dataset]?this.props.selectOptions.odiacYears:this.props.selectOptions.edgarYears,s.a.createElement("div",{className:"SelectPage"},s.a.createElement(y.a,{maxWidth:"xs",className:a.container},s.a.createElement(M.a,{className:a.card,elevation:3},s.a.createElement(k.a,null,s.a.createElement(D.a,{variant:"h5",className:a.headline},"Configure Visualisation"),s.a.createElement(N.a,{container:!0,className:a.root,spacing:4,justify:"center"},s.a.createElement(N.a,{item:!0,xs:12,className:a.gridItem},s.a.createElement(I,{className:a.selectDataset,label:"Dataset",value:this.props.selection.dataset,selectOptions:this.props.selectOptions.dataset,onChange:function(e){return t.props.onChange({dataset:e})}})),s.a.createElement(N.a,{item:!0,xs:12,className:a.gridItem},s.a.createElement(I,{className:a.selectTime,label:"From Month",value:this.props.selection.fromMonth,selectOptions:n,onChange:function(e){return t.props.onChange({fromMonth:e})}}),s.a.createElement(I,{className:a.selectTime,label:"To Month",value:this.props.selection.toMonth,selectOptions:n,onChange:function(e){return t.props.onChange({toMonth:e})}})),s.a.createElement(N.a,{item:!0,xs:12,className:a.gridItem},s.a.createElement(I,{className:a.selectTime,label:"From Year",value:this.props.selection.fromYear,selectOptions:e,onChange:function(e){return t.props.onChange({fromYear:e})}}),s.a.createElement(I,{className:a.selectTime,label:"To Year",value:this.props.selection.toYear,selectOptions:e,onChange:function(e){return t.props.onChange({toYear:e})}})),s.a.createElement(N.a,{item:!0,xs:12,className:a.gridItem},s.a.createElement("div",{className:"ButtonBox"},s.a.createElement("div",{className:a.wrapper},s.a.createElement(j.a,{variant:"contained",color:this.props.fetching?"default":"secondary",onClick:this.props.onFetch,className:a.button},"Fetch Data"),this.props.fetching&&s.a.createElement(x.a,{size:24,className:a.buttonProgress,color:"secondary"})))))))))}}]),t}(s.a.Component),A=E()((function(e){return{container:{},headline:{display:"block",textAlign:"center",marginBottom:e.spacing(3)},gridItem:{display:"flex",alignItems:"center",justifyContent:"center"},selectDataset:{minWidth:200,textAlign:"center"},selectTime:{minWidth:100,marginLeft:e.spacing(4),marginRight:e.spacing(4),textAlign:"center"},button:{color:"white",fontWeight:"500"},wrapper:{marginLeft:e.spacing(.5),marginRight:e.spacing(.5),position:"relative"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}))(V),L=a(10),F=a(353),P=a(255),B=a(351),R={longitude:11.576124,latitude:48.137154,zoom:5,pitch:30,bearing:0},W=function(e){function t(){return Object(h.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=[new B.a({id:"hexagon-layer",data:this.props.dataset,pickable:!1,extruded:!0,radius:5e4,coverage:.6,colorDomain:[0,5],colorRange:[[13,8,135],[62,4,156],[99,0,167],[135,7,166],[166,32,152],[192,58,131],[213,84,110],[231,111,90],[245,140,70],[253,173,50],[252,210,37],[240,249,33]],getColorWeight:function(e){return Math.round(5*e.value)},colorAggregation:"MEAN",elevationScale:3e3,getPosition:function(e){return[e.coordinates[1],e.coordinates[0]]},elevationAggregation:"MEAN",getElevationWeight:function(e){return e.value}})];return s.a.createElement(F.a,{initialViewState:R,controller:!0,layers:e},s.a.createElement(P.a,{mapboxApiAccessToken:"pk.eyJ1IjoiZG9zdHVmZnRoYXRtYXR0ZXJzIiwiYSI6ImNrM3ZobXh5OTBtbmgzZWxrdTN3OXhva20ifQ.HoHL_qBYSvUwvvmggn0HSw"}))}}]),t}(s.a.Component),J=["#0D0887","#3E049C","#6300A7","#8707A6","#A62098","#C03A83","#D5546E","#E76F5A","#F58C46","#FDAD32","#FCD225","#F0F921"],z=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).numberOfDatasets=a.props.data.length,a.state={selectedDataset:0,intervalId:void 0,playing:!1},a.prepareDataset=a.prepareDataset.bind(Object(g.a)(a)),a.prevDataset=a.prevDataset.bind(Object(g.a)(a)),a.nextDataset=a.nextDataset.bind(Object(g.a)(a)),a.onPlay=a.onPlay.bind(Object(g.a)(a)),a.onPause=a.onPause.bind(Object(g.a)(a)),a.getLegend=a.getLegend.bind(Object(g.a)(a)),document.addEventListener("keypress",(function(e){"d"===e.key?(a.onPause(),a.nextDataset()):"a"===e.key?(a.onPause(),a.prevDataset()):" "===e.key&&(a.state.playing?a.onPause():a.onPlay())})),a}return Object(u.a)(t,e),Object(p.a)(t,[{key:"prepareDataset",value:function(){return this.props.data[this.state.selectedDataset]}},{key:"prevDataset",value:function(){this.setState({selectedDataset:(this.state.selectedDataset-1+this.numberOfDatasets)%this.numberOfDatasets})}},{key:"nextDataset",value:function(){this.setState({selectedDataset:(this.state.selectedDataset+1)%this.numberOfDatasets})}},{key:"onPlay",value:function(){var e=setInterval(this.nextDataset,500);this.setState({intervalId:e,playing:!0})}},{key:"onPause",value:function(){clearInterval(this.state.intervalId),this.setState({intervalId:void 0,playing:!1})}},{key:"getLegend",value:function(){var e,t=this.props.classes;if(0===this.props.selection.dataset){e=(this.props.selection.fromYear+this.state.selectedDataset).toString()}else{var a=this.props.selection.fromYear+Math.round((this.props.selection.fromMonth+this.state.selectedDataset)/12-.5001),n=(this.props.selection.fromMonth+this.state.selectedDataset-1)%12+1;console.log(this.props.selection.fromYear,this.props.selection.fromMonth,a,n),e=n.toString()+"/"+a.toString()}var i=this.props.units[this.state.selectedDataset],r=J.map((function(e,a){var n=Math.round(i/12*a,3),r=Math.round(i/12*(a+1),3);return s.a.createElement("div",{className:t.legendLine,style:{backgroundColor:e}},s.a.createElement("p",{className:t.legendLineLabel},n," - ",r," ","\xb5g/(m2*s)"))}));return s.a.createElement(M.a,{className:t.card,elevation:3},s.a.createElement(k.a,{className:Object(L.a)(t.legend,t.cardContent)},s.a.createElement(D.a,{variant:"h5",className:t.legendMonth},e),r))}},{key:"render",value:function(){return s.a.createElement("div",{className:"MapPage"},this.getLegend(),s.a.createElement(W,{dataset:this.prepareDataset()}))}}]),t}(s.a.Component),X=E()((function(e){return{headline:{display:"block",textAlign:"center",marginBottom:e.spacing(4)},card:{position:"absolute",top:e.spacing(2),left:e.spacing(2),zIndex:"1000"},legendMonth:{textAlign:"center",marginBottom:e.spacing(1)},legend:{width:200},legendLine:{display:"block",width:200,borderRadius:3,overflow:"hidden",textAlign:"center",marginBottom:e.spacing(.5),"&:last-child":{marginBottom:e.spacing(0)}},legendLineLabel:{display:"inline-block",padding:e.spacing(1),color:"rgb(255, 255, 255)",fontWeight:"500",textShadow:"0 0 1.5px rgb(0,0,0)"},cardContent:{paddingTop:e.spacing(2),paddingRight:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(2),margin:0,"&:last-child":{paddingBottom:e.spacing(2)}}}}))(z),_=function(e){function t(e){var a;Object(h.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).selectOptions={dataset:{0:"Edgar",1:"Odiac"},edgarYears:{},odiacYears:{},months:{}};for(var n=1970;n<=2018;n++)a.selectOptions.edgarYears[n]=n;for(var s=2e3;s<=2017;s++)a.selectOptions.odiacYears[s]=s;for(var i=1;i<=12;i++)a.selectOptions.months[i]=i;return a.state={mapView:!1,fetching:!1,data:[],units:[],selection:{dataset:1,fromMonth:1,fromYear:2016,toMonth:12,toYear:2016},selectionValid:!0,errorMessageVisible:!1,errorMessageText:""},a.handleSelect=a.handleSelect.bind(Object(g.a)(a)),a.handleFetch=a.handleFetch.bind(Object(g.a)(a)),a}return Object(u.a)(t,e),Object(p.a)(t,[{key:"handleSelect",value:function(e){var t=this.state.selection;Object.assign(t,e),this.state.selection.fromYear>this.state.selection.toYear?this.setState({selection:t,selectionValid:!1,errorMessageVisible:!0,errorMessageText:"Requirement: From Year <= To Year"}):this.state.selection.fromYear===this.state.selection.toYear&&this.state.selection.fromMonth>this.state.selection.toMonth?this.setState({selection:t,selectionValid:!1,errorMessageVisible:!0,errorMessageText:"Requirement: From Month <= To Month"}):this.setState({selection:t,selectionValid:!0,errorMessageVisible:!1,errorMessageText:""})}},{key:"handleFetch",value:function(){var e=this;if(this.state.selectionValid){this.setState({fetching:!0});var t={dataset:this.selectOptions.dataset[this.state.selection.dataset],from_month:this.state.selection.fromMonth,to_month:this.state.selection.toMonth,from_year:this.state.selection.fromYear,to_year:this.state.selection.toYear};console.log({url:f,params:t}),function(e,t){return new Promise((function(a,n){var s;if(window.XMLHttpRequest){(s=new XMLHttpRequest).onreadystatechange=function(){4===this.readyState&&(200===this.status?a(this.responseText):n(this.responseText))};var i="?";for(var r in t)null!==t[r]&&(i+=r+"="+t[r].toString()),i+="&";console.log(i),s.open("GET",e+i,!0),s.send(JSON.stringify(t))}}))}(f,t).then((function(t){var a=JSON.parse(t);e.setState({fetching:!1,mapView:!0,data:a.Datasets,units:a.Maximum})})).catch((function(t){console.log(t);var a=JSON.parse(JSON.stringify(t));e.setState({fetching:!1,errorMessageVisible:!0,errorMessageText:a.Status})}))}}},{key:"render",value:function(){var e=this.props.classes;return s.a.createElement("div",{className:"App"},(!this.state.mapView||this.state.errorMessageVisible)&&s.a.createElement(A,{selection:this.state.selection,selectOptions:this.selectOptions,onChange:this.handleSelect,onFetch:this.handleFetch,fetching:this.state.fetching}),this.state.mapView&&!this.state.errorMessageVisible&&s.a.createElement(X,{data:this.state.data,units:this.state.units,selection:this.state.selection}),this.state.errorMessageVisible&&s.a.createElement(b.a,{className:e.snackbar,open:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"}},s.a.createElement(v.a,{className:e.snackbarContentError,"aria-describedby":"message-id",message:s.a.createElement("span",{id:"message-id"},this.state.errorMessageText)})))}}]),t}(s.a.Component),H=E()((function(e){return{snackbar:{margin:e.spacing(1)},snackbarContentError:{backgroundColor:e.palette.primary.main}}}))(_),q=Object(o.a)({palette:{primary:{main:"#282c34"},secondary:{main:"hsl(340, 100%, 50%)"}}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement((function(){return s.a.createElement(c.a,{theme:q},s.a.createElement(l.BreakpointProvider,null,s.a.createElement(H,null)))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[286,1,2]]]);
//# sourceMappingURL=main.152161a0.chunk.js.map